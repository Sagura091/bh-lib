{"version":3,"sources":["bh_ui/subscription_handlers.cljs"],"mappings":"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","names":["re_frame.core.reg_event_db","day8.re-frame.tracing/is-trace-enabled?","p__41964","vec__41966","cljs.core.nth","+debux-dbg-opts+","day8.re-frame.debux.common.util/send-form!","result__38107__auto__","taoensso.timbre._log_BANG_","taoensso.timbre/*config*","cljs.core/Delay","day8.re-frame.debux.common.util/send-trace!","e","e41988","p__41989","vec__41990","db","_","id","cljs.core.assoc","js/bh-ui","js/bh-ui.subscription-handlers","js/bh-ui.subscription-handlers.event-msg-handler","method-table__4747__auto__","cljs.core.atom","prefer-table__4748__auto__","method-cache__4749__auto__","cached-hierarchy__4750__auto__","hierarchy__4751__auto__","cljs.core.get","fexpr__41993","cljs.core/MultiFn","cljs.core.symbol","bh-ui.subscription-handlers/event-msg-handler","p__41994","map__41995","cljs.core/--destructure-map","event","p__41998","map__41999","?data","msg","bh-ui.data-source-handler/data-source-msg-handler","p__42000","map__42001","ev-msg","vec__42002","old-state-map","new-state-map","re-frame.core/dispatch-sync","p__42008","map__42009","vec__42010","?uid","?csrf-token","?handshake-data","p__42013","map__42014"],"sourcesContent":["(ns bh-ui.subscription-handlers\n  (:require [re-frame.core :as rf]\n            [taoensso.timbre :as log]\n            [bh-ui.data-source-handler :as dh]\n            [day8.re-frame.tracing :refer-macros [fn-traced]]))\n\n\n(rf/reg-event-db\n  ::fully-opened-socket-start\n  (fn-traced [db [_ id]]\n             (log/info \"::sub-handler/fully-opened-websocket-start\" id)\n             (assoc db :pub-sub-started? true)))\n\n(defmulti event-msg-handler :id)\n\n(defmethod event-msg-handler :default\n  [{:keys [event]}]\n  (log/info \"Unhandled event:\" event))\n\n\n(defmethod event-msg-handler :chsk/recv\n  [{:keys [_ ?data] :as msg}]\n\n  ;(log/info \"Push event from server:\" ?data)\n  (dh/data-source-msg-handler ?data))\n\n(defmethod event-msg-handler :chsk/state\n  [{:as ev-msg :keys [?data]}]\n  (let [[old-state-map new-state-map] ?data]\n    (if (:first-open? new-state-map)\n      (do (rf/dispatch-sync [::fully-opened-socket-start])\n          (log/info \"Channel socket successfully established!: \" new-state-map))\n      (log/info \"Channel socket state change: \" new-state-map))))\n\n(defmethod event-msg-handler :chsk/handshake\n  [{:as ev-msg :keys [?data]}]\n  (let [[?uid ?csrf-token ?handshake-data] ?data]\n    (log/info \"WS Handshake for: \" ?uid \" data: \" ?handshake-data)))\n\n(defmethod event-msg-handler :chsk/ws-ping\n  [{:keys [event]}]\n  (log/info \"WS Ping\"))\n\n"]}