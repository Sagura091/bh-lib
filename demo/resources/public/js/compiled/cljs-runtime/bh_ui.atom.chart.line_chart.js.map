{"version":3,"sources":["bh_ui/atom/chart/line_chart.cljs"],"mappings":"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","names":["bh-ui.atom.chart.line-chart/source-code","bh-ui.atom.chart.line-chart/sample-data","bh-ui.utils.example-data/meta-tabular-data","bh-ui.atom.chart.line-chart/sample-config-data","bh-ui.utils.example-data/tabular-column-config-data","bh-ui.atom.chart.line-chart/random-data","bh-ui.utils.example-data/random-meta-tabular-data","bh-ui.atom.chart.line-chart/local-config","data","cljs.core.merge","cljs.core/deref","cljs.core.get_in","cljs.core.filter","p__58798","vec__58799","cljs.core.nth","k","v","cljs.core._EQ_","cljs.core/keys","cljs.core.map_indexed","idx","a","bh-ui.utils.color/get-color","cljs.core.into","bh-ui.atom.chart.line-chart/config","component-id","bh-ui.utils/default-pub-sub","bh-ui.atom.chart.utils/default-config","cljs.core.keyword","cljs.core/assoc-in","bh-ui.atom.chart.line-chart/line-config","label","path","position","re-com.core/v-box","js/goog.DEBUG","bh-ui.atom.chart.utils/boolean-config","cljs.core.conj","re-com.core/h-box","bh-ui.atom.chart.utils/color-config","bh-ui.atom.chart.line-chart/make-line-config","p__58805","vec__58806","bh-ui.atom.chart.line-chart/config-panel","bh-ui.atom.chart.utils/standard-chart-config","re-com.core/line","bh-ui.atom.chart.line-chart/make-line-display","subscriptions","isAnimationActive?","p__58812","vec__58814","_","cljs.core.map","bh-ui.utils/resolve-sub","js/shadow.js.shim.module$recharts.Line","cljs.core.remove","cljs.core/empty?","var_args","args__4870__auto__","len__4864__auto__","i__4865__auto__","argseq__4871__auto__","cljs.core/IndexedSeq","bh-ui.atom.chart.line-chart/component*","p__58820","map__58821","cljs.core/--destructure-map","cljs.core.get","seq58819","self__4852__auto__","cljs.core/seq","container-id","params","d","js/shadow.js.shim.module$recharts.ResponsiveContainer","js/shadow.js.shim.module$recharts.LineChart","bh-ui.atom.chart.utils/standard-chart-components","js/shadow.js.shim.module$recharts.Brush","bh-ui.atom.chart.line-chart/component","p__58823","map__58824","seq58822","input-params","cljs.core.assoc","bh-ui.atom.chart.wrapper-2/component-panel","cljs.core.reduce","cljs.core/into","bh-ui.atom.chart.wrapper-2/base-chart","bh-ui.atom.chart.line-chart/meta-data","re-frame.core/dispatch-sync"],"sourcesContent":["(ns bh-ui.atom.chart.line-chart\n  (:require [bh-ui.atom.chart.utils :as utils]\n            [bh-ui.atom.re-com.configure-toggle :as ct]\n            [bh-ui.utils :as ui-utils]\n            [bh-ui.utils.color :as color]\n            [bh-ui.utils.example-data :as example-data]\n            [bh-ui.utils.helpers :as h]\n            [bh-ui.utils.locals :as l]\n            [bh-ui.atom.chart.wrapper-2 :as wrapper]\n            [re-frame.core :as rf]\n            [re-com.core :as rc]\n            [reagent.core :as r]\n            [taoensso.timbre :as log]\n            [woolybear.ad.layout :as layout]\n            [\"recharts\" :refer [ResponsiveContainer LineChart Line Brush]]))\n\n\n(def source-code '[:> LineChart {:data d}\n                   (utils/standard-chart-components component-id {})\n                   [:> Line (merge {:type              \"monotone\" :dataKey a\n                                    :isAnimationActive @isAnimationActive?\n                                    :stroke            (ui-utils/resolve-sub subscriptions [a :stroke])\n                                    :fill              (ui-utils/resolve-sub subscriptions [a :fill])}\n                                   (when (seq (ui-utils/resolve-sub subscriptions [a :stackId]))\n                                     {:stackId (ui-utils/resolve-sub subscriptions [a :stackId])}))]])\n\n\n(def sample-data example-data/meta-tabular-data)\n(def sample-config-data example-data/tabular-column-config-data)\n(def random-data example-data/random-meta-tabular-data)\n\n\n(defn local-config [data]\n  (merge\n    {:brush false}\n    (->> (get-in @data [:metadata :fields])\n         (filter (fn [[k v]] (= :number v)))\n         keys\n         (map-indexed (fn [idx a]\n                        ;(log/info \"line color\" idx a (ui-utils/get-color idx))\n                        {a {:include true\n                            :stroke  (color/get-color idx)\n                            :fill    (color/get-color idx)}}))\n         (into {}))))\n\n\n(defn- config [component-id data]\n  (-> ui-utils/default-pub-sub\n      (merge\n        utils/default-config\n        {:type      \"line-chart\"\n         :tab-panel {:value     (keyword component-id \"config\")\n                     :data-path [:containers (keyword component-id) :tab-panel]}}\n        (local-config data))\n      (assoc-in [:x-axis :dataKey] (get-in @data [:metadata :id]))))\n\n\n(defn- line-config [component-id label path position]\n  [rc/v-box :src (rc/at)\n   :gap \"5px\"\n   :children [[utils/boolean-config component-id label (conj path :include)]\n              [rc/h-box :src (rc/at)\n               :gap \"5px\"\n               :children [[utils/color-config component-id \":stroke\" (conj path :stroke) position]\n                          [utils/color-config component-id \":fill\" (conj path :fill) position]]]]])\n\n\n(defn- make-line-config [component-id data]\n  (->> (get-in @data [:metadata :fields])\n       (filter (fn [[k v]] (= :number v)))\n       keys\n       (map-indexed (fn [idx a]\n                      [line-config component-id a [a] :above-right]))\n       (into [])))\n\n\n(defn config-panel [data component-id]\n\n  ;(log/info \"config-panel\" data component-id)\n\n  [rc/v-box :src (rc/at)\n   :gap \"10px\"\n   :width \"100%\"\n   :style {:padding          \"15px\"\n           :border-top       \"1px solid #DDD\"\n           :background-color \"#f7f7f7\"}\n   :children [[utils/standard-chart-config data component-id]\n              [rc/line :src (rc/at) :size \"2px\"]\n              [rc/h-box :src (rc/at)\n               :gap \"10px\"\n               :children (make-line-config component-id data)]\n              [rc/line :src (rc/at) :size \"2px\"]\n              [utils/boolean-config component-id \":brush?\" [:brush]]]])\n\n\n(defn- make-line-display [component-id data subscriptions isAnimationActive?]\n\n  ;(log/info \"make-line-display\" data)\n  (->> (get-in data [:metadata :fields])\n       (filter (fn [[_ v]] (= :number v)))\n       keys\n       (map (fn [a]\n              (if (ui-utils/resolve-sub subscriptions [a :include])\n                [:> Line {:type              \"monotone\" :dataKey a\n                          :isAnimationActive @isAnimationActive?\n                          :stroke            (ui-utils/resolve-sub subscriptions [a :stroke])\n                          :fill              (ui-utils/resolve-sub subscriptions [a :fill])}]\n                [])))\n       (remove empty?)\n       (into [:<>])))\n\n\n(defn- component* [& {:keys [data component-id container-id\n                             subscriptions isAnimationActive?]\n                      :as   params}]\n\n  (let [d (if (empty? data) [] (get data :data))]\n\n    ;(log/info \"component*\" data \"//\" d)\n    [:> ResponsiveContainer\n     [:> LineChart {:data d}\n\n      (utils/standard-chart-components component-id {})\n\n      (when (ui-utils/resolve-sub subscriptions [:brush]) [:> Brush])\n\n      (make-line-display component-id data subscriptions isAnimationActive?)]]))\n\n\n(defn component [& {:keys [component-id] :as params}]\n\n  ;(log/info \"component-2\" params)\n\n  (let [input-params (assoc params :component* component*\n                                   :component-panel wrapper/component-panel\n                                   :config config\n                                   :local-config local-config)]\n\n    (reduce into [wrapper/base-chart] (seq input-params))))\n\n\n(def meta-data {:rechart/line {:component component\n                               ;:configurable-component configurable-component\n                               :ports     {:data   :port/sink\n                                           :config :port/sink}}})\n\n\n(rf/dispatch-sync [:register-meta meta-data])\n\n"]}