{"version":3,"sources":["bh_ui/events.cljs"],"mappings":"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","names":["bh-ui.events/default-header","ajax.core/transit-request-format","ajax.core/transit-response-format","bh-ui.csrf/?csrf-token","re_frame.core.reg_event_db","day8.re-frame.tracing/is-trace-enabled?","p__47033","vec__47034","cljs.core.nth","map__47037","cljs.core/--destructure-map","cljs.core.get","+debux-dbg-opts+","day8.re-frame.debux.common.util/send-form!","result__38107__auto__","day8.re-frame.debux.common.util/send-trace!","e","e47047","p__47108","vec__47110","map__47113","db","_","id","value","cljs.core/assoc-in","p__47116","vec__47117","e47132","p__47172","vec__47174","container","init-vals","cljs.core.assoc","p__47183","vec__47184","e47242","p__47249","vec__47251","source","result","current","cljs.core/set","cljs.core.apply","cljs.core/conj","p__47260","vec__47261","taoensso.timbre._log_BANG_","taoensso.timbre/*config*","cljs.core/Delay","e47275","p__47305","vec__47307","re_frame.core.reg_event_fx","p__47319","p__47320","map__47321","vec__47322","e47373","p__47389","p__47390","map__47391","vec__47392","user-id","cljs.core.merge"],"sourcesContent":["(ns bh-ui.events\n  (:require [taoensso.timbre :as log]\n            [re-frame.core :as re-frame]\n            [day8.re-frame.tracing :refer-macros [fn-traced]]\n            [day8.re-frame.http-fx]\n            [ajax.core :as ajax]\n            [bh-ui.csrf :refer [?csrf-token]]))\n\n\n(def default-header {:timeout         8000\n                     :format          (ajax/transit-request-format)\n                     :response-format (ajax/transit-response-format)\n                     :headers         {\"x-csrf-token\" ?csrf-token}})\n\n\n(re-frame/reg-event-db\n  ::data-update\n  (fn-traced [db [_ {:keys [id value]}]]\n    ;(log/info \"::data-update\" id value)\n    (assoc-in db [:sources id] value)))\n\n\n(re-frame/reg-event-db\n  ::init-locals\n  (fn-traced [db [_ container init-vals]]\n    ;(log/info \"::init-locals\" container init-vals)\n    (if (get db container)\n      (do\n        ;(log/info \"::init-locals // already exists\")\n        db)\n      (do\n        ;(log/info \"::init-locals // adding\")\n        (assoc db container init-vals)))))\n\n\n(re-frame/reg-event-db\n  ::good-subscribe-result\n  (fn-traced [db [_ source result]]\n    (let [current (:subscribed db)]\n      ;(log/info \":good-subscribe-result\" source result\n      ;  \"////\" current)\n      (assoc db\n        :subscribed (set (apply conj current source))\n        :subscribe-error \"\"))))\n\n\n(re-frame/reg-event-db\n  ::bad-subscribe-result\n  (fn-traced [db [_ source result]]\n    (log/info \"::bad-subscribe-result\" source result)\n    (assoc db\n      :subscribe-error result)))\n\n\n(re-frame/reg-event-fx\n  ::subscribe-to\n  (fn-traced [{:keys [db]} [_ source]]\n    (let [user-id (:user-id db)]\n      ;(log/info \"::subscribe-to\" source\n      ; \"////\" {:user-id user-id :data-sources source}\n      ; \"////\" ?csrf-token)\n      {:http-xhrio (merge default-header\n                     {:method     :post\n                      :uri        \"/subscribe/data-source\"\n                      :params     {:user-id user-id :data-sources source}\n                      :on-success [::good-subscribe-result source]\n                      :on-failure [::bad-subscribe-result source]})})))\n\n"]}